<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Making your first Phaser 3 Game - Part 3</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.50.0/dist/phaser.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>

<body>

    <script type="text/javascript">
        const BACKGROUND = "background"
        const PLAYER = "player"
        const DRAGON = "dragon"
        const TREASURE = "treasure"
        const CUTECAT = "cutecat"
        const CUTECAT2 = "cutecat2"
        const DOWN = "down"
        const UP = "up"
        const LEFT = "left"
        const RIGHT = "right"


        let gameScene = new Phaser.Scene('Game');
        var cursors;
        var config = {
            type: Phaser.AUTO,
            width: 600,
            height: 360,
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: {
                        y: 0
                    },
                    debug: true
                }
            },
            scene: gameScene
        };

        let game = new Phaser.Game(config);


        gameScene.init = function () {
            this.playerSpeed = 1.5;
        }
        gameScene.preload = function () {
            this.load.image(BACKGROUND, 'assets/background.png');
            this.load.image(PLAYER, 'assets/player.png');
            this.load.image(DRAGON, 'assets/dragon.png');
            this.load.image(TREASURE, 'assets/treasure.png');
            this.load.spritesheet(CUTECAT, 'assets/cutecat.png', {
                frameWidth: 32,
                frameHeight: 32
            });
            this.load.spritesheet(CUTECAT2, 'assets/cutecat3.png', {
                frameWidth: 32,
                frameHeight: 32
            });
                

        }

        gameScene.create = function () {
            this.add.image(0, 0, BACKGROUND).setOrigin(0, 0)

            // player
            this.player = this.add.sprite(40, this.sys.game.config.height / 2, CUTECAT2);
            this.player.setScale(1.5);
            //this.setCollideWorldBounds(true);
            this.player.currentState = DOWN


            // treasure
            this.treasure = this.add.sprite(this.sys.game.config.width - 80, this.sys.game.config.height / 2,
                TREASURE);
            this.treasure.setScale(0.5)

            this.anims.create({
                key: RIGHT,
                frames: this.anims.generateFrameNumbers(CUTECAT2, {
                    start: 6,
                    end: 8
                }),
                frameRate: 10,
                repeat: -1
            });            
            this.anims.create({
                key: DOWN,
                frames: this.anims.generateFrameNumbers(CUTECAT2, {
                    start: 0,
                    end: 2
                }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: UP,
                frames: this.anims.generateFrameNumbers(CUTECAT2, {
                    start: 9,
                    end: 11
                }),
                frameRate: 10,
                repeat: -1
            });

            this.anims.create({
                key: LEFT,
                frames: this.anims.generateFrameNumbers(CUTECAT2, {
                    start: 3,
                    end: 5
                }),
                frameRate: 10,
                repeat: -1
            });
            cursors = this.input.keyboard.createCursorKeys();

        }

        gameScene.update = function () {
            // check for active input
            if (cursors.left.isDown) {
                this.player.x -= this.playerSpeed;
                this.player.currentState = LEFT
                this.player.anims.play(this.player.currentState, true);
            } else if (cursors.right.isDown) {
                this.player.x += this.playerSpeed;
                this.player.currentState = RIGHT
                this.player.anims.play(this.player.currentState,true);
            }else if(cursors.up.isDown){
                this.player.y -= this.playerSpeed;
                this.player.currentState = UP
                this.player.anims.play(this.player.currentState,true);
            }else if(cursors.down.isDown){
                this.player.y += this.playerSpeed;
                this.player.currentState = DOWN
                this.player.anims.play(this.player.currentState,true);
            }else{
                this.player.anims.play(this.player.currentState);
            }

        }
    </script>

</body>

</html>